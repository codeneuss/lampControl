<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LampControl">
    <title>LampControl - ELK-BLEDOM Controller</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%230a84ff;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%235ac8fa;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Ccircle cx='50' cy='50' r='45' fill='url(%23grad)' opacity='0.2'/%3E%3Cpath d='M50 20 L50 45 M35 50 L65 50' stroke='url(%23grad)' stroke-width='6' stroke-linecap='round'/%3E%3Ccircle cx='50' cy='65' r='12' fill='url(%23grad)'/%3E%3Cpath d='M42 77 L58 77' stroke='url(%23grad)' stroke-width='4' stroke-linecap='round'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="/static/css/styles.css?v=3">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-brand">
                <svg class="app-logo" width="32" height="32" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#0a84ff;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#5ac8fa;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <circle cx="50" cy="50" r="45" fill="url(#logoGrad)" opacity="0.15"/>
                    <path d="M50 20 L50 45 M35 50 L65 50" stroke="url(#logoGrad)" stroke-width="7" stroke-linecap="round"/>
                    <circle cx="50" cy="65" r="13" fill="url(#logoGrad)"/>
                    <path d="M40 80 L60 80" stroke="url(#logoGrad)" stroke-width="5" stroke-linecap="round"/>
                </svg>
                <h1>LampControl</h1>
            </div>
            <div class="header-device-selector">
                <select id="device-dropdown" class="device-dropdown">
                    <option value="">Scanning...</option>
                </select>
                <div id="connection-status" class="status-indicator">
                    <span class="status-dot"></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="container">
        <!-- Main Tabs -->
        <section class="panel" id="main-panel">
            <div class="main-tabs">
                <button class="main-tab active" data-tab="lamp">Lamp Control</button>
                <button class="main-tab" data-tab="twitch">Twitch</button>
            </div>

            <!-- Lamp Control Tab -->
            <div id="lamp-tab" class="main-tab-content active">
                <div id="no-device-message" class="message info">
                    Select a device first
                </div>

                <div id="controls" class="hidden">
                    <!-- Power Toggle -->
                    <div class="control-group power-control">
                        <button id="power-btn" class="power-btn off">
                            <span class="power-icon">‚ö°</span>
                            <span class="power-text">Power Off</span>
                        </button>
                    </div>

                    <!-- Brightness Slider -->
                    <div class="control-group">
                        <label for="brightness-slider">
                            Brightness
                            <span id="brightness-value" class="value-display">100%</span>
                        </label>
                        <input type="range" id="brightness-slider" min="0" max="255" value="255" class="slider">
                    </div>

                    <!-- Mode Selector -->
                    <div class="control-group">
                        <div class="mode-tabs">
                            <button class="mode-tab active" data-mode="color">Color</button>
                            <button class="mode-tab" data-mode="white">White</button>
                            <button class="mode-tab" data-mode="effects">Effects</button>
                            <button class="mode-tab" data-mode="sound">Sound</button>
                        </div>
                    </div>

                <!-- Color Mode -->
                <div id="color-mode" class="mode-content active">
                    <div class="color-picker-container">
                        <canvas id="color-picker" width="300" height="300"></canvas>
                        <div id="color-preview"></div>
                    </div>
                    <div class="color-sliders">
                        <div class="slider-group red">
                            <label for="red-slider">
                                Red
                                <span id="red-value" class="value-display">255</span>
                            </label>
                            <input type="range" id="red-slider" min="0" max="255" value="255" class="slider">
                        </div>
                        <div class="slider-group green">
                            <label for="green-slider">
                                Green
                                <span id="green-value" class="value-display">0</span>
                            </label>
                            <input type="range" id="green-slider" min="0" max="255" value="0" class="slider">
                        </div>
                        <div class="slider-group blue">
                            <label for="blue-slider">
                                Blue
                                <span id="blue-value" class="value-display">0</span>
                            </label>
                            <input type="range" id="blue-slider" min="0" max="255" value="0" class="slider">
                        </div>
                    </div>
                </div>

                <!-- White Balance Mode -->
                <div id="white-mode" class="mode-content">
                    <div class="slider-group warm">
                        <label for="warm-slider">
                            Warm White
                            <span id="warm-value" class="value-display">128</span>
                        </label>
                        <input type="range" id="warm-slider" min="0" max="255" value="128" class="slider">
                    </div>
                    <div class="slider-group cold">
                        <label for="cold-slider">
                            Cold White
                            <span id="cold-value" class="value-display">128</span>
                        </label>
                        <input type="range" id="cold-slider" min="0" max="255" value="128" class="slider">
                    </div>
                </div>

                <!-- Effects Mode -->
                <div id="effects-mode" class="mode-content">
                    <button id="create-effect-btn" class="btn btn-primary">
                        <span class="btn-icon">‚ú®</span>
                        Create Custom Effect
                    </button>
                    <div id="effects-gallery" class="effects-gallery"></div>
                    <div class="slider-group">
                        <label for="effect-speed-slider">
                            Effect Speed
                            <span id="effect-speed-value" class="value-display">128</span>
                        </label>
                        <input type="range" id="effect-speed-slider" min="0" max="255" value="128" class="slider">
                    </div>
                </div>

                <!-- Sound Mode -->
                <div id="sound-mode" class="mode-content">
                    <div class="sound-controls">
                        <button id="sound-toggle-btn" class="btn btn-primary">
                            <span class="btn-icon">üéµ</span>
                            <span id="sound-btn-text">Start Sound Reactive</span>
                        </button>
                        <div id="audio-visualizer" class="audio-visualizer hidden">
                            <canvas id="audio-canvas" width="300" height="100"></canvas>
                        </div>
                        <div class="slider-group">
                            <label for="sound-sensitivity-slider">
                                Sensitivity
                                <span id="sound-sensitivity-value" class="value-display">50%</span>
                            </label>
                            <input type="range" id="sound-sensitivity-slider" min="0" max="100" value="50" class="slider">
                        </div>
                    </div>
                </div>

                </div>
            </div>

            <!-- Twitch Tab -->
            <div id="twitch-tab" class="main-tab-content">
                <div class="twitch-status-header">
                    <span id="twitch-connection-status" class="twitch-status-indicator">‚óè</span>
                    <span id="twitch-connection-text">Disconnected</span>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="twitch-enabled">
                        <span>Enable Twitch Integration</span>
                    </label>
                </div>

                <div class="form-group">
                    <label for="twitch-channel">Channel Name</label>
                    <input type="text" id="twitch-channel" placeholder="your_channel_name">
                </div>

                <div class="form-group">
                    <label for="twitch-bot-username">Bot Username</label>
                    <input type="text" id="twitch-bot-username" placeholder="bot_username">
                </div>
                <div class="form-group">
                    <label for="twitch-token">Access Token</label>
                    <div class="token-input-group">
                        <input type="password" id="twitch-token" placeholder="oauth:...">
                        <button type="button" id="get-oauth-btn" class="btn btn-secondary">Get Token</button>
                    </div>
                    <small class="help-text">Get your OAuth token to connect to Twitch chat</small>
                </div>

                <div class="form-group">
                    <label for="effect-duration">
                        Effect Duration
                        <span id="effect-duration-value" class="value-display">30s</span>
                    </label>
                    <input type="range" id="effect-duration" min="5" max="300" value="30" class="slider">
                </div>

                <div class="form-group">
                    <label for="global-cooldown">
                        Global Cooldown
                        <span id="global-cooldown-value" class="value-display">5s</span>
                    </label>
                    <input type="range" id="global-cooldown" min="0" max="60" value="5" class="slider">
                </div>

                <div class="form-group">
                    <label for="user-cooldown">
                        User Cooldown
                        <span id="user-cooldown-value" class="value-display">30s</span>
                    </label>
                    <input type="range" id="user-cooldown" min="0" max="300" value="30" class="slider">
                </div>

                <div class="form-group">
                    <label>Cooldown Bypass</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="vip-bypass" checked>
                            <span>VIPs</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="sub-bypass" checked>
                            <span>Subscribers</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="mod-bypass" checked>
                            <span>Moderators</span>
                        </label>
                    </div>
                </div>

                <button id="save-twitch-config" class="btn btn-primary">Save Configuration</button>

                <div id="active-effect" class="active-effect hidden">
                    <h4>Active Viewer Effect</h4>
                    <p><strong>User:</strong> <span id="effect-username"></span></p>
                    <p><strong>Command:</strong> <span id="effect-command"></span></p>
                    <p><strong>Remaining:</strong> <span id="effect-remaining"></span>s</p>
                </div>

                <div class="available-commands">
                    <h4>Available Commands</h4>
                    <p><strong>Colors:</strong> <span id="available-colors">Loading...</span></p>
                    <p><strong>Effects:</strong> <span id="available-effects">Loading...</span></p>
                </div>
            </div>
        </section>

        <!-- Error Display -->
        <div id="error-display" class="message error hidden"></div>
    </main>

    <!-- Create Effect Modal -->
    <div id="effect-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Create Custom Effect</h3>
            <form id="effect-form">
                <div class="form-group">
                    <label for="effect-name">Effect Name</label>
                    <input type="text" id="effect-name" placeholder="My Custom Effect" required>
                </div>
                <div class="form-group">
                    <label>Colors (click to add)</label>
                    <div id="color-swatches" class="color-swatches"></div>
                    <button type="button" id="add-color-btn" class="btn btn-secondary">Add Color</button>
                </div>
                <div class="form-group">
                    <label for="effect-pattern">Pattern</label>
                    <select id="effect-pattern" required>
                        <option value="fade">Fade</option>
                        <option value="jump">Jump</option>
                        <option value="strobe">Strobe</option>
                        <option value="pulse">Pulse</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="effect-speed-input">
                        Speed
                        <span id="effect-speed-input-value" class="value-display">128</span>
                    </label>
                    <input type="range" id="effect-speed-input" min="0" max="255" value="128" class="slider">
                </div>
                <div class="form-actions">
                    <button type="button" id="cancel-effect-btn" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Effect</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/static/js/app.js?v=3"></script>
</body>
</html>
